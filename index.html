<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel ="stylesheet" href="tweetDesign.css">
  </head>
  <body>
    <header>
      <h1 class= "title">Twittler</h1>
      <p>Stay connected with the world</p>
      <nav> 
        <ul>
          <li class="refresh">Refresh Feed</li>
          <li class ="home">Home</li>
        </ul>
      </nav>
    </header>
    <section class="tweetFeed">
    </section>
    <script>

      $(document).ready(function(){
        var $body = $('body');

        function twittle(source, x){
          var tweet = source[x];
          var $tweet = $('<div class = "tweet"></div>');
          $tweet.html('@<span class="name">'+tweet.user+'</span>:' + tweet.message);
          var $time = $('<div class = "time">'+tweet.created_at+'</div>');
          $time.appendTo($tweet);
          return $tweet;
        }


        $('.tweetFeed').val("streams.home")
        var index = streams.home.length -1;
        while(index >= 0){
          twittle(streams.home, index).appendTo($('.tweetFeed'));
          index -= 1;
        }
    
        $('.refresh').on('click', function(){
          console.log("clicked refresh");
          var source = $('.tweetFeed').val();
          var whole = source.length; 
          var count = whole-($('div').length);
          while(count >= 0){
            twittle(source,(whole-count-1)).prependTo($('.tweetFeed'));
            count -=1; 
          }
        });

        $('.name').on('click', function(){
          console.log("CLICKED");
          var user = $(this).text();
          var feed = streams.users[user]
          var count = feed.length-1;
          $('.tweetFeed').empty();
          $('.tweetFeed').val(feed);
          while(count>=0){
            twittle(feed, count).appendTo($('.tweetFeed'));
            count -=1; 
          }
        });

        $('.home').on('click', function(){
          $('.tweetFeed').empty();
          var count = streams.home.length-1;
          $('.tweetFeed').val('streams.home');
          while(count >=0){
            twittle(streams.home, count).appendTo(".tweetFeed");
            count -=1; 
          }
        })

      });

    </script>
  </body>
</html>
